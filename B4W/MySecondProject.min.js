b4w.module.export_function=function(a,f){var h=f("transform"),k=f("scenes");a.get_data_of_obj0_from_scene=function(a,d){var b=f(a),e=k.get_object_by_name(a,d),n=k.get_object_children(e)[0],c=b.is_melee,r=null;c||(r=b.get_bullet(d));return{obj:e,skeleton:n,angle:0,id:d,melee:c,bullet:r,steam_id:d,delay_death_anim:b.delay_death_anim,spawn:b.spawn,idle:b.idle,attack_phase1_obj0:b.attack_phase1_obj0,attack_phase2_obj0:b.attack_phase2_obj0,death:b.death}};a.get_data_of_obj_from_scene=function(a,d){var b=
f(a),e=k.get_object_by_name(a,d),n=k.get_object_children(e)[0],c=b.is_melee,r=null;c||(r=b.get_bullet(d));return{obj:e,skeleton:n,angle:0,playerName:"",id:d,melee:c,bullet:r,steam_id:0,is_dead:!1,spawn:b.spawn,idle:b.idle,attack_phase1_obj:b.attack_phase1_obj,win:b.win,death:b.death}};a.set_obj_in_world=function(a,d,b,e,n){var c;do c=e();while(-1!=b.indexOf(c));b.push(c);a.angle=c;h.set_translation(a.skeleton,Math.sin(c)*n,-Math.cos(c)*n,0);d.rotate_obj(a.skeleton,c+Math.PI)}};b4w.module.axe=function(a,f){function h(c,a,b){c.angle<a-b/2?(e.rotate_obj(c.skeleton,c.angle+b),c.angle+=b,setTimeout(function(){h(c,a,b)},7)):c.angle=a}function k(c,a,b){c.angle>a-b/2?(e.rotate_obj(c.skeleton,c.angle+b),c.angle+=b,setTimeout(function(){k(c,a,b)},7)):c.angle=a}var g=f("material"),d=f("scenes"),b=f("animation"),e=f("root");a.is_melee=!0;a.get_bullet=function(c){return null};a.delay_death_anim=500;a.spawn=function(){e.play_animation(this.skeleton,"spawn");d.show_object(this.obj)};
a.idle=function(c){void 0===c&&(c=!0);var a=this.skeleton;if(!b.is_play(a)){var d="idle_B4W_BAKED";8<10*Math.random()&&(d=0==Math.round(Math.random())?"idle_alt_B4W_BAKED":"idle_alt2_B4W_BAKED");c?e.play_animation(a,d):e.play_animation(a,d,null)}};a.attack_phase1_obj0=function(){e.play_animation(this.skeleton,"counter_helix_statue");var c=d.get_object_by_name("axe_counter_helix",this.id);setTimeout(function(){g.set_nodemat_value(c,["countr_helix_effect","show"],1);n(c,0,0)},40)};var n=function(c,
a,b){if(4>a)g.set_nodemat_value(c,["countr_helix_effect","x_axis"],a/2),a+=1;else if(0==b)a=1,b=1.34,g.set_nodemat_value(c,["countr_helix_effect","x_axis"],0),g.set_nodemat_value(c,["countr_helix_effect","y_axis"],b);else{b=a=0;g.set_nodemat_value(c,["countr_helix_effect","show"],0);g.set_nodemat_value(c,["countr_helix_effect","x_axis"],0);g.set_nodemat_value(c,["countr_helix_effect","y_axis"],0);return}setTimeout(function(){n(c,a,b)},55)};a.attack_phase2_obj0=function(c){var a=(c-this.angle)/50,
b=this;0<a?setTimeout(function(){h(b,c,a)},1):setTimeout(function(){k(b,c,a)},1);e.play_animation(this.skeleton,"culling_blade")};a.death=function(){var c=this;e.play_animation(this.skeleton,"death",null);setTimeout(function(){e.transform_death_obj(c,0)},4E3)}};b4w.module.cm=function(a,f){function h(a,c,b){if(.25<=b)e.play_animation(a.skeleton,"deathsim",null),setTimeout(function(){k(a,c)},1200);else{var d=g.get_materials_names(c),f;for(f in d)g.set_nodemat_value(c,[d[f],"mix_value"],b);setTimeout(function(){h(a,c,b+.01)},25)}}function k(a,c){var b=g.get_materials_names(c),d;for(d in b)g.set_nodemat_value(c,[b[d],"mix_value"],.6);setTimeout(function(){e.transform_death_obj(a,0)},2E3)}var g=f("material"),d=f("scenes"),b=f("animation"),e=f("root");a.is_melee=
!1;a.get_bullet=function(a){return d.get_object_by_name("bullet",a)};a.delay_death_anim=0;a.spawn=function(){var a=d.get_object_by_name("cm_deathsim_partical",this.id);e.play_animation(this.skeleton,"spawn_B4W_BAKED");d.show_object(this.obj);d.hide_object(this.bullet);d.hide_object(a)};a.idle=function(a){void 0===a&&(a=!0);var c=this.skeleton;if(!b.is_play(c)){var d="idle";8<10*Math.random()&&(d="idle_alt2");a?e.play_animation(c,d):e.play_animation(c,d,null)}};a.attack_phase1_obj=function(){b.is_play(this.skeleton)||
this.is_dead||(0==Math.round(Math.random())?e.play_animation(this.skeleton,"attack"):e.play_animation(this.skeleton,"attack2"))};a.attack_phase2_obj0=function(a){return null};a.death=function(){this.is_dead=!0;var a=this;e.play_animation(this.skeleton,"die",function(){var c=d.get_object_by_name("cm_deathsim_partical",a.id);e.play_animation(a.skeleton,"deathsim_bind",null);d.hide_object(a.obj);d.show_object(c);h(a,c,0)})};a.win=function(){e.play_animation(this.skeleton,"win")}};b4w.module.root=function(a,f){var h=f("animation"),k=f("transform"),g=f("scenes");a.animation_of_state=null;a.rotate_obj=function(a,b){k.set_rotation(a,0,0,Math.sin(b/2),Math.cos(b/2))};a.transform_death_obj=function(d,b){10>b?(b+=.05,k.set_translation(d.obj,0,0,-b),setTimeout(function(){a.transform_death_obj(d,b)},10)):setTimeout(function(){g.hide_object(d.obj)},500)};a.play_animation=function(d,b,e){void 0===e&&(e=a.animation_of_state);h.apply(d,b);h.set_behavior(d,h.AB_FINISH_STOP);h.play(d,e)}};b4w.register("MySecondProject_main",function(a,f){function h(){return H[Math.floor(12*Math.random())]}function k(a,e){e?(B.create_preloader(),a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},C.animation_of_state=c,t.load(x+"MySecondProject.json",b,d),g()):console.log("b4w init failure")}function g(){y="axe";t.load(x+y+".json",n)}function d(a){B.update_preloader(a)}function b(a,b){if(b){D.enable_camera_controls();var d="http://localhost:60217/";try{d=document.baseURI.split("B4W")[0]}catch(N){}d=
d.replace("http","ws")+"b4w_frame";v=new WebSocket(d);v.onclose=function(a){a.wasClean?console.log("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e \u0447\u0438\u0441\u0442\u043e"):console.log("\u041e\u0431\u0440\u044b\u0432 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f");console.log("\u041a\u043e\u0434: "+a.code+" \u043f\u0440\u0438\u0447\u0438\u043d\u0430: "+a.reason)};v.onmessage=function(a){var b,d;try{d=JSON.parse(a.data),
b=d.Item1}catch(I){console.log("WebSocket Error :-S in B4W->Socket",I)}switch(b){case "add_user":a={heroName:d.Item2,playerName:d.Item3,steamId:d.Item4};q.push({data:a,is_used:!1});t.load(x+a.heroName+".json",e);break;case "start_phase1":u=1;c();break;case "start_phase2":u=2;w=Math.floor(Math.random()*l.length);c();break;case "restart":for(a=l.length-1;0<=a;--a)t.unload(l[a].id),l.pop();t.unload(m.id);m=void 0;u=0;q=[];g()}}}else console.log("b4w scene load failure")}function e(a,c){if(c)if(12<=l.length)setTimeout(t.unload,
5E3,a);else{for(var b=0;b<q.length&&!0===q[b].is_used;)b+=1;if(b>=q.length&&q[b-1].is_used)v.send({state:"trouble when choose hero to player"});else{q[b].is_used=!0;var b=q[b].data,d=z.get_data_of_obj_from_scene(b.heroName,a);z.set_obj_in_world(d,C,J,h,35);d.steam_id=b.steamId;d.playerName=b.playerName;l.push(d);d.spawn()}}else console.log("b4w load failure")}function n(a,b){b?m?setTimeout(t.unload,1E3,a):(m=z.get_data_of_obj0_from_scene(y,a),m.spawn()):console.log("b4w load failure")}function c(){switch(u){case 0:r();
break;case 1:G();A();break;case 2:E.is_play(m.skeleton)||(m.idle(!1),setTimeout(K,1E3*Math.random()+500));A();break;case 3:m.death();l[w].win();u=4;break;case 4:l[w].idle()}}function r(){m.idle();l.forEach(function(a){a.idle()})}function G(){E.is_play(m.skeleton)||(m.idle(),setTimeout(function(){m.attack_phase1_obj0()},1200*Math.random()+300))}function A(){l.forEach(function(a){a.attack_phase1_obj()})}function K(){for(var a=0;!0===l[a].is_dead||a===w;){if(a+1>=l.length){u=3;return}a+=1}m.attack_phase2_obj0(l[a].angle);
setTimeout(function(){l[a].death()},m.delay_phase2)}var D=f("app"),L=f("config"),t=f("data"),B=f("preloader"),M=f("version");f("objects");var E=f("animation"),C=f("root"),z=f("export_function"),m,y,l=[],v,q=[],p=Math.PI,H=[0,p/6,p/3,p/2,4*p/6,5*p/6,p,7*p/6,8*p/6,3*p/2,10*p/6,11*p/6],J=[],w,u=0,F="DEBUG"==M.type(),x=L.get_assets_path("MySecondProject");a.init=function(){D.init({canvas_container_id:"main_canvas_container",callback:k,show_fps:F,console_verbose:F,autoresize:!0})}});b4w.require("MySecondProject_main").init();
